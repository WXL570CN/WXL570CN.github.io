(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{366:function(t,a,e){"use strict";e.r(a);var s=e(7),r=Object(s.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"hydration"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#hydration"}},[t._v("#")]),t._v(" hydration")]),t._v(" "),e("p",[t._v("[")]),t._v(" "),e("h2",{attrs:{id:"脱水"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#脱水"}},[t._v("#")]),t._v(" "),e("code",[t._v("脱水")])]),t._v(" "),e("p",[t._v("](https://tanstack.com/query/latest/docs/react/reference/hydration#dehydrate)")]),t._v(" "),e("p",[t._v("dehydrate 创建缓存的冻结表示，稍后可以使用 Hydrate、useHydrate 或 hydrate 对其进行水合。这对于将预取查询从服务器传递到客户端或将查询持久保存到 localStorage 或其他持久位置很有用。默认情况下它只包括当前成功的查询。")]),t._v(" "),e("div",{staticClass:"language-tsx extra-class"},[e("pre",{pre:!0,attrs:{class:"language-tsx"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" dehydrate "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@tanstack/react-query'")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" dehydratedState "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("dehydrate")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("queryClient"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("  shouldDehydrateQuery"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("p",[e("strong",[t._v("选项")])]),t._v(" "),e("ul",[e("li",[e("code",[t._v("客户端：查询客户端")]),t._v(" "),e("ul",[e("li",[e("strong",[t._v("必需的")])]),t._v(" "),e("li",[t._v("应该脱水的queryClient")])])]),t._v(" "),e("li",[e("code",[t._v("选项：脱水选项")]),t._v(" "),e("ul",[e("li",[t._v("选修的")]),t._v(" "),e("li",[e("code",[t._v("脱水突变：布尔值")]),t._v(" "),e("ul",[e("li",[t._v("选修的")]),t._v(" "),e("li",[t._v("是否脱水突变。")])])]),t._v(" "),e("li",[e("code",[t._v("脱水查询：布尔值")]),t._v(" "),e("ul",[e("li",[t._v("选修的")]),t._v(" "),e("li",[t._v("是否脱水查询。")])])]),t._v(" "),e("li",[e("code",[t._v("shouldDehydrateMutation: (mutation: Mutation) => 布尔值")]),t._v(" "),e("ul",[e("li",[t._v("选修的")]),t._v(" "),e("li",[t._v("为缓存中的每个突变调用此函数")]),t._v(" "),e("li",[t._v("返回 true 以将此突变包含在脱水中，否则返回 false")]),t._v(" "),e("li",[t._v("默认版本仅包含暂停的突变")]),t._v(" "),e("li",[t._v("如果您想在保留以前行为的同时扩展功能，请导入并执行 defaultShouldDehydrateMutation 作为 return 语句的一部分")])])]),t._v(" "),e("li",[e("code",[t._v("shouldDehydrateQuery: (query: Query) => 布尔值")]),t._v(" "),e("ul",[e("li",[t._v("选修的")]),t._v(" "),e("li",[t._v("为缓存中的每个查询调用此函数")]),t._v(" "),e("li",[t._v("返回 true 以将此查询包含在脱水中，否则返回 false")]),t._v(" "),e("li",[t._v("默认版本只包括成功的查询，做 shouldDehydrateQuery: () => true 包括所有查询")]),t._v(" "),e("li",[t._v("如果您想在保留以前行为的同时扩展功能，请导入并执行 defaultShouldDehydrateQuery 作为返回语句的一部分")])])])])])]),t._v(" "),e("p",[e("strong",[t._v("Returns")])]),t._v(" "),e("ul",[e("li",[e("code",[t._v("脱水状态：脱水状态")]),t._v(" "),e("ul",[e("li",[t._v("这包括稍后补充 queryClient 所需的一切")]),t._v(" "),e("li",[t._v("您不应该依赖此响应的确切格式，它不是公共 API 的一部分并且可以随时更改")]),t._v(" "),e("li",[t._v("此结果不是序列化形式，如果需要，您需要自己做")])])])]),t._v(" "),e("p",[t._v("[")]),t._v(" "),e("h3",{attrs:{id:"限制"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#限制"}},[t._v("#")]),t._v(" 限制")]),t._v(" "),e("p",[t._v("](https://tanstack.com/query/latest/docs/react/reference/hydration#limitations)")]),t._v(" "),e("p",[t._v("一些存储系统（例如浏览器 Web Storage API）要求值是 JSON 可序列化的。如果您需要对不能自动序列化为 JSON 的值进行脱水处理（例如 Error 或 undefined），您必须自己序列化它们。由于默认只包含成功的查询，要包含错误，您必须提供 shouldDehydrateQuery，例如：")]),t._v(" "),e("div",{staticClass:"language-tsx extra-class"},[e("pre",{pre:!0,attrs:{class:"language-tsx"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// serverconst state = dehydrate(client, { shouldDehydrateQuery: () => true }) // to also include Errorsconst serializedState = mySerialize(state) // transform Error instances to objects")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// clientconst state = myDeserialize(serializedState) // transform objects back to Error instanceshydrate(client, state)")]),t._v("\n")])])]),e("p",[t._v("[")]),t._v(" "),e("h2",{attrs:{id:"水合物"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#水合物"}},[t._v("#")]),t._v(" "),e("code",[t._v("水合物")])]),t._v(" "),e("p",[t._v("](https://tanstack.com/query/latest/docs/react/reference/hydration#hydrate)")]),t._v(" "),e("p",[t._v("hydrate 将先前脱水的状态添加到缓存中。")]),t._v(" "),e("div",{staticClass:"language-tsx extra-class"},[e("pre",{pre:!0,attrs:{class:"language-tsx"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" hydrate "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@tanstack/react-query'")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("hydrate")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("queryClient"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" dehydratedState"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("p",[e("strong",[t._v("选项")])]),t._v(" "),e("ul",[e("li",[e("code",[t._v("客户端：查询客户端")]),t._v(" "),e("ul",[e("li",[e("strong",[t._v("必需的")])]),t._v(" "),e("li",[t._v("queryClient 将状态混合到")])])]),t._v(" "),e("li",[e("code",[t._v("脱水状态：脱水状态")]),t._v(" "),e("ul",[e("li",[e("strong",[t._v("必需的")])]),t._v(" "),e("li",[t._v("水合物进入客户端的状态")])])]),t._v(" "),e("li",[e("code",[t._v("选项：HydrateOptions")]),t._v(" "),e("ul",[e("li",[t._v("选修的")]),t._v(" "),e("li",[e("code",[t._v("默认选项：默认选项")]),t._v(" "),e("ul",[e("li",[t._v("选修的")]),t._v(" "),e("li",[t._v("mutations: MutationOptions 用于水合突变的默认突变选项。")]),t._v(" "),e("li",[t._v("查询：QueryOptions 用于混合查询的默认查询选项。")])])]),t._v(" "),e("li",[e("code",[t._v("上下文？：React.Context<QueryClient |未定义>")]),t._v(" "),e("ul",[e("li",[t._v("使用它来使用自定义 React 查询上下文。否则，将使用 defaultContext。")])])])])])]),t._v(" "),e("p",[t._v("[")]),t._v(" "),e("h3",{attrs:{id:"限制-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#限制-2"}},[t._v("#")]),t._v(" 限制")]),t._v(" "),e("p",[t._v("](https://tanstack.com/query/latest/docs/react/reference/hydration#limitations-1)")]),t._v(" "),e("p",[t._v("如果 dehydration 中包含的查询已经存在于 queryCache 中，hydrate 不会覆盖它们，它们将被静默丢弃。")]),t._v(" "),e("p",[t._v("[")]),t._v(" "),e("h2",{attrs:{id:"使用水合物"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使用水合物"}},[t._v("#")]),t._v(" "),e("code",[t._v("使用水合物")])]),t._v(" "),e("p",[t._v("](https://tanstack.com/query/latest/docs/react/reference/hydration#usehydrate)")]),t._v(" "),e("p",[t._v("useHydrate 将先前的脱水状态添加到 queryClient 中，该状态将由 useQueryClient() 返回。如果客户端已经包含数据，新查询将根据更新时间戳智能合并。")]),t._v(" "),e("div",{staticClass:"language-tsx extra-class"},[e("pre",{pre:!0,attrs:{class:"language-tsx"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" useHydrate "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@tanstack/react-query'")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("useHydrate")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dehydratedState"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("p",[e("strong",[t._v("选项")])]),t._v(" "),e("ul",[e("li",[e("code",[t._v("脱水状态：脱水状态")]),t._v(" "),e("ul",[e("li",[e("strong",[t._v("必需的")])]),t._v(" "),e("li",[t._v("补水的状态")])])]),t._v(" "),e("li",[e("code",[t._v("选项：HydrateOptions")]),t._v(" "),e("ul",[e("li",[t._v("选修的")]),t._v(" "),e("li",[e("code",[t._v("默认选项：查询选项")]),t._v(" "),e("ul",[e("li",[t._v("用于混合查询的默认查询选项。")])])]),t._v(" "),e("li",[e("code",[t._v("上下文？：React.Context<QueryClient |未定义>")]),t._v(" "),e("ul",[e("li",[t._v("使用它来使用自定义 React 查询上下文。否则，将使用 defaultContext。")])])])])])]),t._v(" "),e("p",[t._v("[")]),t._v(" "),e("h2",{attrs:{id:"补水"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#补水"}},[t._v("#")]),t._v(" "),e("code",[t._v("补水")])]),t._v(" "),e("p",[t._v("](https://tanstack.com/query/latest/docs/react/reference/hydration#hydrate-1)")]),t._v(" "),e("p",[t._v("Hydrate 将 useHydrate 包装到组件中。当您需要类组件中的 hydrate 或在 QueryClientProvider 呈现的同一级别上需要 hydrate 时可能很有用。")]),t._v(" "),e("div",{staticClass:"language-tsx extra-class"},[e("pre",{pre:!0,attrs:{class:"language-tsx"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" Hydrate "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@tanstack/react-query'")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("App")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Hydrate")])]),t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("state")]),e("span",{pre:!0,attrs:{class:"token script language-javascript"}},[e("span",{pre:!0,attrs:{class:"token script-punctuation punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("dehydratedState"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),e("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("...")]),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Hydrate")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[e("strong",[t._v("选项")])]),t._v(" "),e("ul",[e("li",[e("code",[t._v("状态：脱水状态")]),t._v(" "),e("ul",[e("li",[t._v("补水的状态")])])]),t._v(" "),e("li",[e("code",[t._v("选项：HydrateOptions")]),t._v(" "),e("ul",[e("li",[t._v("选修的")]),t._v(" "),e("li",[e("code",[t._v("默认选项：查询选项")]),t._v(" "),e("ul",[e("li",[t._v("用于混合查询的默认查询选项。")])])]),t._v(" "),e("li",[e("code",[t._v("上下文？：React.Context<QueryClient |未定义>")]),t._v(" "),e("ul",[e("li",[t._v("使用它来使用自定义 React 查询上下文。否则，将使用 defaultContext。")])])])])])]),t._v(" "),e("p",[e("a",{attrs:{href:"https://github.com/tanstack/query/tree/main/docs/react/reference/hydration.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("在 GitHub 上编辑"),e("OutboundLink")],1)])])}),[],!1,null,null,null);a.default=r.exports}}]);